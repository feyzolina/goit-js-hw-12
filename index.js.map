{"version":3,"file":"index.js","sources":["../src/js/init.js","../src/main.js"],"sourcesContent":["window.global ||= window;","import './js/init';\nimport iziToast from \"izitoast\";\nimport \"izitoast/dist/css/iziToast.min.css\";\nimport SimpleLightbox from \"simplelightbox\";\nimport \"simplelightbox/dist/simple-lightbox.min.css\";\nimport axios from 'axios';\n\nlet page = 1;\nlet perPage = 140;\nlet loadedPosts = [];\nlet currentSearchTerm = '';\nconst searchForm = document.querySelector('#searchForm');\nconst galleryDiv = document.querySelector('.gallery');\nconst loadingSpinnerDiv = document.querySelector('.loader');\nconst loadMoreBtn = document.querySelector('#loadMoreBtn');\n\nfunction showLoading() {\n  console.log(\"Yükleme başladı, buton gizleniyor\");\n  loadingSpinnerDiv.style.display = 'block';\n  loadMoreBtn.classList.add('hidden');\n}\n\nfunction hideLoading() {\n  console.log(\"Yükleme bitti, buton görünür oluyor\");\n  loadingSpinnerDiv.style.display = 'none';\n  loadMoreBtn.classList.remove('hidden');\n}\n\nfunction showErrorMessage(type) {\n  if (type === 'noImages') {\n    iziToast.error({\n      message: 'Sorry, there are no images matching your search query. Please try again!',\n      position: 'topRight'\n    });\n  } else if (type === 'endOfResults') {\n    iziToast.info({\n      message: \"We're sorry, but you've reached the end of search results.\",\n      position: 'topRight'\n    });\n  } else {\n    iziToast.error({\n      message: 'An unexpected error occurred. Please try again later.',\n      position: 'topRight'\n    });\n  }\n}\n\n\nsearchForm.addEventListener('submit', async function (event) {\n  event.preventDefault();\n  const search = document.querySelector('#search').value.trim();\n\n  if (search !== currentSearchTerm) {\n    currentSearchTerm = search;\n    page = 1;\n    loadedPosts = [];\n  }\n\n  showLoading();\n\n  try {\n    const posts = await fetchPosts(search);\n\n    if (posts.length <= 0) {\n      showErrorMessage('noImages');\n      loadMoreBtn.classList.add('hidden');\n      document.querySelector('#search').value = '';\n    } else {\n      loadedPosts = posts;\n      renderPosts(posts);\n      page += 1;\n      loadMoreBtn.classList.remove('hidden');\n    }\n\n    document.querySelector('#search').value = '';\n  } catch (error) {\n    console.log(error);\n  } finally {\n    loadingSpinnerDiv.style.display = 'none';\n  }\n});\n\nasync function fetchPosts(search) {\n  const apiKey = '48254147-b4b10b5266c157a9a3946e15d';\n  const searchParams = new URLSearchParams({\n    q: search,\n    image_type: 'photo',\n    orientation: 'horizontal',\n    safesearch: true,\n    per_page: perPage,\n    page: page\n  });\n  const url = `https://pixabay.com/api/?key=${apiKey}&${searchParams.toString()}`;\n\n  try {\n    const response = await axios.get(url);\n    const totalHits = response.data.totalHits;\n    const totalPages = Math.ceil(totalHits / perPage);\n\n    if (totalHits === 0) {\n      throw new Error('noImages');\n    }\n\n    if (page > totalPages) {\n      throw new Error('endOfResults');\n    }\n\n    return response.data.hits;\n  } catch (error) {\n    if (error.message === 'noImages') {\n      showErrorMessage('noImages');\n      document.querySelector('#search').value = '';\n    }  else {\n      showErrorMessage('endOfResults');\n    }\n    throw error;\n  }\n}\n\n\nfunction renderPosts(images, append = false) {\n  const galleryContent = images\n    .map(image => {\n      return `\n        <a href=\"${image.largeImageURL}\" class=\"image-card\">\n          <img src=\"${image.webformatURL}\" alt=\"${image.tags}\" />\n          <div class=\"image-info\">\n            <div class=\"likes\">\n              <p class=\"likes-text\">Likes</p>\n              <p class=\"likes-count\">${image.likes}</p>\n            </div>\n            <div class=\"views\">\n              <p class=\"views-text\">Views</p>\n              <p class=\"views-count\">${image.views}</p>\n            </div>\n            <div class=\"comments\">\n              <p class=\"comments-text\">Comments</p>\n              <p class=\"comments-count\">${image.comments}</p>\n            </div>\n            <div class=\"downloads\">\n              <p class=\"downloads-text\">Downloads</p>\n              <p class=\"downloads-count\">${image.downloads}</p>\n            </div>\n          </div>\n        </a>\n      `;\n    }).join('');\n\n  if (append) {\n    galleryDiv.insertAdjacentHTML('beforeend', galleryContent);\n  } else {\n    galleryDiv.innerHTML = galleryContent;\n  }\n\n  const lightbox = new SimpleLightbox('.gallery a', {\n    captionsData: 'alt',\n    captionDelay: 250\n  });\n  lightbox.refresh();\n}\n\nloadMoreBtn.addEventListener('click', async function (event) {\n  event.preventDefault();\n  showLoading();\n\n  try {\n    const posts = await fetchPosts(currentSearchTerm);\n    renderPosts(posts, true);\n    page += 1;\n\n    const galleryItems = document.querySelectorAll('.image-card');\n    if (galleryItems.length > 0) {\n      const firstItemHeight = galleryItems[0].getBoundingClientRect().height;\n\n      window.scrollBy({\n        top: firstItemHeight * 2.0,\n        behavior: 'smooth'\n      });\n    }\n\n  } catch (error) {\n    if (!loadMoreBtn.classList.contains('hidden')) {\n      showErrorMessage('endOfResults');\n    }\n  } finally {\n    hideLoading();\n  }\n});\n"],"names":["page","perPage","loadedPosts","currentSearchTerm","searchForm","galleryDiv","loadingSpinnerDiv","loadMoreBtn","showLoading","hideLoading","showErrorMessage","type","iziToast","event","search","posts","fetchPosts","renderPosts","error","apiKey","searchParams","url","response","axios","totalHits","totalPages","images","append","galleryContent","image","SimpleLightbox","galleryItems","firstItemHeight"],"mappings":"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"}